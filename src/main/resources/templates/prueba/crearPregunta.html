<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="ISO-8859-1">
<title>Crear Pruebas</title>

<link rel="stylesheet"
	href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
	integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
	crossorigin="anonymous">

<style>
.cabezal {
	display: flex;
	flex-direction: row;
	align-items: center;
}

.seccionOpciones {
	
}
</style>

<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="/js/jquery.tabletojson.min.js"></script>


<script type="text/javascript">
	//Invoco al servidor solo para pedir la porción de la página que contiene las 
	//preguntas filtradas según el criterio del usuario 
	
	function cargarFragmentoVerdaderoFalso() {
		$(".nav-link").removeClass('active');
		$("#tabFV").addClass('active');
		
		$("#seccion-crear-opciones").load(
				'/prueba/crearPregunta/verdaderoFalso'); //llamada axaj
	}

	function cargarFragmentoMultipleOpcion() {
		$(".nav-link").removeClass('active');
		$("#tabMO").addClass('active');
		
		$("#seccion-crear-opciones").load(
				'/prueba/crearPregunta/multipleOpcion'); //llamada axaj
	}

	//Construye a mano el html que representa una fila de la tabla
	function agregarPregunta(idPreg, enunciado) {
		var colId = '<td>' + idPreg + '</td>';
		var colEnunciado = '<td>' + enunciado + '</td>';
		var colNotas = '<td> <input type="text" size="2" value="1"></td>';
		var botonBorrar = '<td><a class="btn btn-warning btn-sm" id="botonBorrar" onclick="quitar(this)">Quitar</a></td>'

		var fila = '<tr>' + colId + colEnunciado + colNotas + botonBorrar
				+ '</tr>';

		//agrega fila a la tabla
		$('#tabla-preguntas tr:last').after(fila);
	}

	//Elimina fila al apretar el boton Quitar
	function quitar(boton) {
		var p = boton.parentNode.parentNode;
		p.parentNode.removeChild(p);
	}

	//realizo una invocación http para enviar al servidor en formato json las preguntas seleccionadas
	function enviarPreguntas() {
		var data = $('#tabla-preguntas').tableToJSON();
		var url = '/prueba/guardarPrueba';

		fetch(url, {
			method : "POST",
			body : JSON.stringify(data),
			headers : {
				"Content-type" : "application/json; charset=UTF-8"
			}
		})

	}

	function agregarOpcion() {
		var enunciado = document.getElementById('tituloOpcion').value;
		var colEnunciado = '<td>' + enunciado + '</td>';

		var radio = '<input type="radio" name="radio" />';
		var colCorrecta = '<td> <div> ' + radio + ' </div> </td>';

		var botonBorrar = '<td><a class="btn btn-warning btn-sm" id="botonBorrar" onclick="quitar(this)">Quitar</a></td>'

		var fila = '<tr>' + colEnunciado + colCorrecta + botonBorrar + '</tr>';

		//agrega fila a la tabla
		$('#tabla-opciones tr:last').after(fila);
	}

	function guardarPregunta() {
		alert("Pregunta guardada");
	}
	
</script>

</head>
<body>
	<div class="cabezal">
		<div class="container my-2" align="center">

			<div class="card">
				<h5 class="card-header">Nueva pregunta</h5>
				<div class="card-body">
					<p class="font-weight-normal">Seleccione el tipo de pregunta
						que quiere crear</p>
				</div>
			</div>

		</div>
	</div>



	<div class="opciones">

		<div class="container my-2" align="center">
			<nav class="nav nav-pills flex-column flex-sm-row">
				<a class="flex-sm-fill text-sm-center nav-link" href="#"
					onclick="cargarFragmentoVerdaderoFalso()" id="tabVF">Verdadero/Falso</a>
				<a class="flex-sm-fill text-sm-center nav-link" href="#"
					onclick="cargarFragmentoMultipleOpcion()" id="tabMO">Multiple opcion</a>

			</nav>
		</div>
	</div>

	<div class="seccionCrearOpciones" id="seccion-crear-opciones"></div>

	<div class="seccionListarOpciones" id="seccion-listar-opciones">
	</div>
</body>
</html>
